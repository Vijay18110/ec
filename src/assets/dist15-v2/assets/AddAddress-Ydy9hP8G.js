import{d as o,c as b,b as y,j as t,f as l,m as k,n as C,e as I}from"./index-CQ0pFaA9.js";import{u as R,q as r,w as S,y as D}from"./App-9vCfEsS0.js";const w=({isaddress:x})=>{const e=o(s=>s.cartreducer.address),d=b(),m=o(s=>s.cartreducer.pincode),i=s=>{const{id:a,value:n}=s.target;d(l.setAddress({field:a,value:n}))},f=async s=>{var a,n;if(d(l.setPinCode(s.target.value)),s.target.value.length==6){const c=await(await fetch(`https://api.tantrash.com/API/Pincode/TTPLPincode?pincode=${s.target.value}`)).json();d(l.setMultipleFields({city:((a=c==null?void 0:c.pincodeList[0])==null?void 0:a.districtName)||"",state:((n=c==null?void 0:c.pincodeList[0])==null?void 0:n.stateName)||"",country:"India"}))}else d(l.setMultipleFields({city:"",state:""}))},{sendApiRequest:g,status:A}=R();o(s=>s.uireducer.address);const[N,p]=y.useState(!1),u=o(s=>s.addressreducer.address),h=async()=>{if(JSON.parse(sessionStorage.getItem("loggedInUser"))){const{obj:a}=await S();d(C.setAddress(a==null?void 0:a.Response))}};y.useEffect(()=>{h()},[A]);const v=u==null?void 0:u.lstAddressData.find(s=>(s==null?void 0:s.IsDefault)=="True"),j=()=>{const s=JSON.parse(sessionStorage.getItem("loggedInUser"));try{p(!0),D(e)&&(g("POST","/AddEditShippingAddress",{AddressId:"",CustomerId:s.CustomerId,PesronName:e.fullName,AddressName:e.address,AddressType:e.addressType,IsDefaultAddress:v?e.isDefault:"True",AddressContactNo:e.mobile,State:e.state,City:e.city,Country:e.country,PinCode:m,Address1:"",Landmark:e.landMark},"",!0),h(),d(I.setaddresss()),d(l.setPinCode(null)),d(l.setMultipleFields({address:"",addressType:"",city:"",fullName:"",isDefault:!1,landMark:"",mobile:"",state:""})))}catch(a){console.log(a.message)}finally{p(!1)}};return t.jsxs("div",{className:"my-4",children:[!x&&t.jsx("h4",{className:"mb-4",children:"Add Address"}),t.jsxs("div",{className:"card p-4",children:[t.jsx(r,{handleChange:i,id:"fullName",isRequired:!0,placeholder:"Full Name",type:"text",value:e==null?void 0:e.fullName}),t.jsx(r,{handleChange:i,id:"address",isRequired:!0,placeholder:"Address*",type:"text",value:e==null?void 0:e.address}),t.jsx(r,{handleChange:i,id:"addressType",isRequired:!0,placeholder:"Address Type*",type:"text",value:e==null?void 0:e.addressType}),t.jsx(r,{handleChange:i,id:"landMark",placeholder:"Apartment/Suite etc. (optional)",type:"text",value:e==null?void 0:e.landMark}),t.jsxs("div",{className:"row",children:[t.jsx("div",{className:"col-md-6 mb-1",children:t.jsx(r,{handleChange:f,max:6,isRequired:!0,placeholder:"Pincode*",type:"number",value:m})}),t.jsx("div",{className:"col-md-6",children:t.jsx(r,{isRequired:!0,placeholder:"City*",type:"text",value:e==null?void 0:e.city,isReadonly:!0})})]}),t.jsxs("div",{className:"row",children:[t.jsx("div",{className:"col-md-6 ",children:t.jsx(r,{id:"state",isRequired:!0,isReadonly:!0,placeholder:"state*",type:"text",value:e==null?void 0:e.state})}),t.jsx("div",{className:"col-md-6 mb-3",children:t.jsx(r,{handleChange:i,id:"country",isRequired:!0,isReadonly:!0,placeholder:"City*",type:"text",value:e==null?void 0:e.country})})]}),t.jsxs("div",{className:"mb-3 d-flex",children:[t.jsx("span",{className:"input-group-text border-end-0 rounded-end-0 mb-3",children:"+91"}),t.jsx("input",{type:"text",className:"form-control rounded-start-0 mb-3",onChange:i,id:"mobile",placeholder:"Phone Number",value:e==null?void 0:e.mobile,required:!0,maxLength:10,onKeyDown:s=>{!/[0-9]/.test(s.key)&&s.key!=="Backspace"&&s.key!=="Delete"&&s.key!=="ArrowLeft"&&s.key!=="ArrowRight"&&s.preventDefault()}})]}),t.jsxs("div",{className:"form-check mb-3",children:[t.jsx("input",{className:"form-check-input",type:"checkbox",id:"isDefault",checked:e==null?void 0:e.isDefault,onChange:s=>d(l.setAddress({field:s.target.id,value:s.target.checked}))}),t.jsx("label",{className:"form-check-label",htmlFor:"defaultAddress",children:"Set as default address"})]}),t.jsx("button",{type:"submit",className:"btn btn-primary w-100",style:{backgroundColor:"#597545"},"data-bs-dismiss":"modal",onClick:j,children:"Save Address"}),N&&t.jsx(k,{})]})]})};export{w as default};
